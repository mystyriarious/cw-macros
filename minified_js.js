// Content Warning Macro by Mistyrious
// Last tested Sugarcube 2.36.1, July 10 2024
var sens_topics=[],warning_uppercase=!1;Macro.add("cwList",{handler:function(){if(this.args.length>2)return this.error("Too many arguments! Make sure all content warnings are in the first argument separated by spaces, and the second argument is only true or false");if(0==this.args.length)return this.error('Please specify the variables pertaining to each trigger in quotes, separated by a space. For example: "violence death"');var e=this.args[0].split(" ");for(let s=0;s<e.length;s++){var t=e[s],r=State.variables[t];if(void 0===r)return this.error("One of the content warnings is not associated with a variable! Please fix so that each warning is the same name as the variable that is being set for each trigger");r?sens_topics.includes(t)||sens_topics.push(t):sens_topics.includes(t)&&sens_topics.splice(sens_topics.indexOf(t),1)}this.args.length>1&&!0==this.args[1]&&(warning_uppercase=!0)}}),Macro.add("warn",{handler:function(){if(this.args.length<2)return this.error("Need to specify ID and warnings!");let e=this.args[0];var s=this.args[1].split(" "),t=[];if(this.args.length>2){var r=this.args[2].split(", ");if(r.length>s.length)return this.error("Specified too many warning names");if(r.length<s.length)return this.error("Specified too little warning names; make sure the warning names are in the same order as the warnings you specified")}var n=[];for(let a=0;a<s.length;a++)for(let i=0;i<sens_topics.length;i++)s[a]!=sens_topics[i]||(t.push(s[a]),void 0===r||n.includes(r[a])||n.push(r[a]));if(this.args.length<=2&&!0==warning_uppercase&&t.length>0){var h=t[0].charAt(0).toUpperCase();t[0]=h+t[0].slice(1)}var l=t.join(", ");this.args.length>2&&n.length>0&&(h=n[0].charAt(0).toUpperCase(),n[0]=h+n[0].slice(1),l=n.join(", ")),$(document).one(":passagedisplay",function(s){var r=document.getElementById(e),n=r.innerHTML;t.length>0&&$(r).wiki("<<replace '#"+e+"'>><<linkreplace '<b>CW:</b> "+l+"' t8n>>"+n+"<</linkreplace>><</replace>>")})}});
